Task 1
The input Amazon food dataset (Reviews.csv) lists all the reviews per-row (one review per
line), and it is comma-separated. In each line, two of the columns represent the user id and
product id (third and second columns, respectively). The schema of Reviews.csv is the
following:
Id,ProductId,UserId,ProfileName,HelpfulnessNumerator,HelpfulnessDenominator,Score,Time,Summary,Text
On the web site you can download the file ReviewsSample.csv. It contains a sample of
Reviews.csv. You can use it to perform some initial tests.
Write a single Spark application that:
1. Transposes the original Amazon food dataset, obtaining an RDD of pairs (tuples) of
the type:
(user_id, list of the product_ids reviewed by user_id)
The returned RDD contains one pair/tuple for each user, which contains the user_id
and the complete list of (distinct) products reviewed by that user. If user user_id
reviewed more times the same product, that product must occur only one time in the
returned list of the product_ids reviewed by user_id;
2. Counts the frequencies of all the pairs of products reviewed together (the frequency of
a pair of products is given by the number of users who reviewed both products);
3. Stores on the output folder all the pairs of products that appear more than once and
their frequencies. The pairs of products must be sorted by decreasing frequency. 